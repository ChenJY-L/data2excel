# Data2excel

用于将`.dat`数据文件批量整理成Excel文件。

### 📝 更新日志

* 3427522 - [bug]  1. 修复legend删除错误问题 [bug]  2. 添加高度数据时，错误覆盖的问题 [feat] 3. 新增功能，在标注框线时，使用高度区分文本框 (2025-06-10)
* ee26581 - [feat] 添加相对高度绘制功能 (2025-06-05)
* e8a09c6 - [bug]修复中文导致的界面启动卡顿 (2025-06-05)
* b243e86 - 1. 使用Augment对主函数进行了重构 2. 添加了新功能，可以绘制1550-1050的差分图像 (2025-06-04)
* 774a676 - 1. 修改坐标轴tick类型 2. 坐标轴的颜色设置为黑色 3. 标注框的字体设置为28 (2025-05-26)
* 3aee330 - 修正无法读取7环数据的bug，优化了文件名读取的逻辑 (2025-04-15)
* e68bc7e - 最终打包版本，修改了字体和图题的大小 (2025-04-08)
* fa0ecc8 - 设置时间框的颜色，修改备注框的逻辑 (2025-04-08)
* 021d004 - 坐标轴文字加粗，更改虚线类型 (2025-04-08)
* 6a2ccd6 - First commit (2025-03-27)

### 🛠️ 使用方法

#### 📝备注txt文件示例

```yaml
# 井号开头的行会被忽略
15:57-16:10：10	# 冒号（中文和英文都可）
16:10-16:19：7	# 时间段会绘制为框
16:19-16:28：6	# 如果冒号后仅包含数字，则会认为是高度备注，会导出到温度sheet中
16:28-16:50：5	# 文字信息和数字信息会上下交替出现
17:20-17:37：上举 # 文字备注框线的高度被设置为数字框的80%
17:59：坐姿抬腿	  # 时间点会绘制为一条直线
备注：	# 检测到备注后，后续的全部内容都会复制到excel的文本框中
1、3MPET胶固定
2、上举测量
3、右手休息高度在0cm
```

#### 🖼️默认绘图内容（可定制🫡）

| 标题                                | 主坐标轴          | 副坐标轴       | 备注     |
| ----------------------------------- | ----------------- | -------------- | -------- |
| 12环差分信号vs.室温                 | Diff12            | 室温           |          |
| 23环差分信号vs.测头旁皮肤温度       | Diff23            | 测头旁温度     |          |
| 1050nm单环吸光度                    | 1050              |                |          |
| 1219nm单环吸光度                    | 1219              |                |          |
| 34环差分信号vs.加热功率             | Diff34            | 加热功率       | 框       |
| 45环差分信号vs.测头相对扶手高度(cm) | Diff45            | 相对扶手高度   | 文字＋框 |
| 1314nm单环吸光度                    | 1314              |                | 框       |
| 1409nm单环吸光度                    | 1409              |                | 框       |
| 1050nm差分吸光度vs.测头下实际温度   | Diff1050          | 测头下实际温度 |          |
| 1550nm差分吸光度 - 1050nm差分吸光度 | Diff1550-Diff1050 |                |          |
| 1550nm单环吸光度                    | 1550              |                |          |
| 1609nm单环吸光度                    | 1609              |                |          |



#### 🔘Check Box

- Temperature: 
- Plot: 是否绘制图片
- OGTT: 是否包含血糖数据
- LD: 
- Dynamic Base: 
- Info for All: 是否在全部Plot中添加备注框线（目前仅在Diff45图中添加文本）
- 1550-1050: 是否导出波长差分数据

### 📦 编译为 EXE

目前代码使用`Nuitka`进行打包

编译命令：

 ```bash
 python -m nuitka --standalone --show-progress --remove-output --assume-yes-for-downloads --output-dir="D:\build" --main="data2excel.py" --windows-icon-from-ico="favicon01.ico" --enable-plugin=pyqt6 --windows-console-mode=disable
 ```

编译完成后需要使用`Enigma Virtual Box`封包为单一exe文件。